---
title: "Excel Files"
---

```{r, echo=FALSE}
dataDir <- "data/"
```


## Loading Excel Files

Many datasets, especially those shared outside of academic or statistical contexts, come in Excel format. R provides multiple packages to work with Excel workbooks.

The `readxl` package, part of the tidyverse, is a lightweight and reliable tool for reading .xlsx files without requiring external dependencies. We use `read_excel()` to read a specific worksheet:

```{r}
library(readxl)
titanic2 <- read_excel(paste0(dataDir, "example_data.xlsx"), sheet = "titanic")
```

An alternative is the `openxlsx` package, which offers both reading and writing capabilities. It's useful when you need more control over formatting or workbook structure:

```{r}
library(openxlsx)
titanic3 <- read.xlsx(paste0(dataDir, "example_data.xlsx"), sheet = "titanic")
```

After loading the data, we can inspect the structure with:

```{r}
str(titanic2)
str(titanic3)
```

Each function achieves a similar result—reading data from the "titanic" worksheet—but when we want to be more specific about what we want to load, the two functions use different command. `readxl` is more minimal, while `openxlsx` is more feature-rich.



```{webr-r}
#| autorun: true
#| context: setup
dir.create("data")
setwd("/home/web_user/data")
download.file("https://raw.githubusercontent.com/p3piit/exp_rawdata/main/example_data.xlsx", "example_data.xlsx")
setwd("/home/web_user")
```

::: practice

## Practice

a. Use the `openxlsx::read.xlsx()` function to load the first 100 rows (not counting column names) of the first 4 columns from the 'diabetes' sheet in the Excel workbook stored as "example_data.xlsx" in the directory data
b. Use the `readxl::read_excel()` function with an appropriate specification for the `range` argument to load the chunk of data beginning on Row 3 and Column 2 and ending on Row 100 and Column 7 from the 'titanic' sheet in "example_data.xlsx".

:::: {.panel-tabset}
## {{< var tab_title.editor >}}

```{webr-r}
```

## {{< var tab_title.solution >}}


```{r}
library(openxlsx)
read.xlsx("data/example_data.xlsx", sheet = "diabetes", rows = 1:101, cols = 1:4)

library(readxl)
read_excel("data/example_data.xlsx", sheet = "titanic", range = "B3:G100", col_names = FALSE)
```
::::

:::









